<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>瀑布</title>
</head>

<body>

<canvas id='myCanvas' width='1000' height='600' style="background:black"></canvas>

<script>

	var canvas = document.getElementById('myCanvas');
	var ctx = canvas.getContext('2d');
	
	var startList = [];
	
	function init(){
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;
	}
	
	init();
	
	window.onresize = init;
	
	canvas.addEventListener('mousemove',function(event){
		var e = event;
		startList.push(new Star(e.offsetX,e.offsetY));
	})
	
	function Star(x,y){
		this.x = x;
		this.y = y;
		
		this.vx = (Math.random()-0.5)*10;
		this.vy = (Math.random()-0.5)*20;
		
		this.a = 1;
		this.color = randomColor();
		
		this.draw();
		
	}
	
	function randomColor(){
		
		var a = Math.floor(Math.random()*256);
		var b = Math.floor(Math.random()*256);
		var c = Math.floor(Math.random()*256);
		
		return 'rgba('+a+','+b+','+c+')';
		
	}
	
	Star.prototype = {
	
		draw:function(){
			ctx.beginPath();
			ctx.fillStyle = this.color;
			ctx.globalAlpha = this.a;
			
			ctx.globalCompositeOperation = 'lighter';
			ctx.arc(this.x,this.y,Math.random()*4,0,2*Math.PI,false);
			ctx.fill();
			this.update();
		},
		
		update:function(){
			/*this.x += this.vx;*/
			this.y += this.vy;
			
			this.a *= 0.99;//线的长度
		}
	};
	
	function render(){
		startList.forEach(function(item,i){
			item.draw();
			if(item.a < 0.1){
				startList.splice(i,1);
			}
		})
		window.requestAnimationFrame(render);
	};
	render();
	
	
	
</script>

</body>
</html>
